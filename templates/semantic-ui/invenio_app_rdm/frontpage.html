{#
  Copyright (C) 2019-2020 CERN.
  Copyright (C) 2019-2020 Northwestern University.
  Copyright (C) 2021 New York University.

  Invenio App RDM is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}
{%- extends "invenio_theme/frontpage.html" %}

{%- block page_header %}
{%- include "invenio_app_rdm/header_frontpage.html" %}
{%- endblock page_header %}
{%- from "invenio_app_rdm/macros/authors.html" import creators -%}
{%- block page_body %}
<div class="ui divider hidden"></div>
<div class="ui stackable grid">

  <div class="ui stackable centered two column grid">
    <div class="stretched row">
      <div class="eight wide column">
        <h2 class="ui center aligned header">
          Recent uploads
        </h2>
        {% if not records %}
        <div class="ui centered grid">
          <p style="font-size: medium;">{{_('There are no public records to show.')}}</p>
        </div>
        {% endif %}

        {%- for r in records %}
        {%- set creation_date = r.created|from_isodatetime -%}
        {%- set record_url = url_for('invenio_app_rdm_records.record_detail', pid_value=r.id) %}
        <div class="ui divided items">
          <div class="item">
            <a href="{{ record_url }}" class="image">
              {% if r.metadata.cover %}
              <img src="{{ r.metadata.cover }}" alt="Record cover">
              {% endif %}
            </a>
            <div class="content"><a href="{{ record_url }}" class="header no-decoration">{{ r.metadata.title }}</a>
              <div class="meta"><span class="cinema">{{ creators(r.metadata.creators) }}</span></div>
              <div class="description">
                <div class="ui justified container">
                  <p>{{ r.metadata.description | striptags | truncate(300) }}</p>
                </div>
              </div>
              <div class="extra">
                <div class="ui tiny label blue" data-tooltip="{{_('Publication date')}}">
                  {{ r.metadata.publication_date }} {{ '(' ~ r.metadata.version ~ ')' if r.metadata.version }}
                </div>
                <div class="ui tiny label grey" data-tooltip="{{_('Resource type')}}">
                  {{ r.ui.resource_type.title_l10n }}
                </div>
                <div class="ui tiny label access-status {{ r.ui.access_status.id }}" data-tooltip="{{ r.ui.access_status.description_l10n }}">
                  {% if r.ui.access_status.icon %}<i class="icon {{ r.ui.access_status.icon }}"></i>{% endif %}
                  {{ r.ui.access_status.title_l10n }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="ui divider"></div>
        {%- endfor %}
        {% if records %}
        <div class="ui centered grid">
          <a class="ui button more" href="{{url_for('invenio_search_ui.search')}}">{{_('More')}}</a>
        </div>
        {%- endif %}
      </div>
      <div class="four wide column">
        <a class="twitter-timeline" data-height="800" href="https://twitter.com/INGVvulcani?ref_src=twsrc%5Etfw">Tweets by INGVvulcani</a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
      </div>
    </div>
  </div>
</div>

{%- endblock page_body %}
